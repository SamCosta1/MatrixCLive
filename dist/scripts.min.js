function Fraction(t,e){this.bottom=e,this.top=t,void 0==t&&(this.top=0),void 0==e&&("string"==typeof t&&t.includes("/")?(this.top=parseFloat(t.split("/")[0]),this.bottom=parseFloat(t.split("/")[1])):this.bottom=1);var i,r;if((i=this.top%1!=0)||(r=this.bottom%1!=0)){var a=i?this.top.toString().split(".")[1].length:0,n=r?this.bottom.toString().split(".")[1].length:0,s=Math.pow(10,n>a?n:a);this.top*=s,this.bottom*=s}var o=GCD(this.top,this.bottom);this.top/=o,this.bottom/=o,this.bottom<0&&(this.top*=-1,this.bottom*=-1),this.parseLiteral=function(t){return t instanceof Fraction?t:new Fraction(t)},this.simplify=function(){var t=GCD(this.top,this.bottom);this.top/=t,this.bottom/=t,this.bottom<0&&(this.top*=-1,this.bottom*=-1)},this.divide=function(t){t=this.parseLiteral(t);var e=new Fraction;return e.top=this.top*t.bottom,e.bottom=this.bottom*t.top,e.simplify(),e},this.times=function(t){if(t=this.parseLiteral(t),0==this.top||0==t.top)return new Fraction(0,1);var e=new Fraction;return e.bottom=this.bottom*t.bottom,e.top=this.top*t.top,e.simplify(),e},this.power=function(t){t=this.parseLiteral(t);for(var e=t.top,i=this.clone(),r=1;r<e;r++)i=i.times(this);return i},this.add=function(t){t=this.parseLiteral(t);var e=new Fraction;return e.top=this.top*t.bottom+this.bottom*t.top,e.bottom=this.bottom*t.bottom,e.simplify(),e},this.subtract=function(t){t=this.parseLiteral(t);var e=new Fraction;return e.top=this.top*t.bottom-this.bottom*t.top,e.bottom=this.bottom*t.bottom,e.simplify(),e},this.reciprocal=function(){return 0!=this.top?new Fraction(this.bottom,this.top):new Fraction(0,1)},this.getLiteral=function(){return this.top/this.bottom},this.isZero=function(){return 0==this.top},this.isOne=function(){return this.bottom==this.top==1},this.toString=function(){return 0==this.top?0:1==this.bottom?this.top:this.top==this.bottom?1:this.top+"/"+this.bottom},this.clone=function(){return new Fraction(this.top,this.bottom)}}function GCD(t,e){var i=t%e;return 0==i?e:GCD(e,i)}function Matrix(t,e){this.matrix=t,this.multiplier=new Fraction(1,1),void 0==t?this.matrix=getZeros(3).matrix:isNaN(t)||(this.matrix=getZeros(t,e).matrix),this.update=function(t,e,i){this.matrix[parseInt(t)][parseInt(e)]=i instanceof Fraction?i:new Fraction(i)},this.getCell=function(t,e){return this.matrix[t][e]},this.numRows=function(){return this.matrix.length},this.numCols=function(){return this.matrix[0].length},this.clone=function(){for(var t=[],e=0;e<this.numRows();e++){for(var i=[],r=0;r<this.numCols();r++)i.push(this.getCell(e,r).clone());t.push(i)}return new Matrix(t)},this.determinant=function(){if(2==this.numRows())return this.getCell(0,0).times(this.getCell(1,1)).subtract(this.getCell(1,0).times(this.getCell(0,1)));for(var t=this.reduceToReducedEchF(),e=t.multiplier,i=t.numRows()-1,r=new Fraction,a=1,n=0;n<t.numCols();n++,a*=-1)0!=t.matrix[i][n]&&(r=r.add(t.subMatrix(i,n).det().times(a).times(t.matrix[i][n])));return r.times(e)},this.subMatrix=function(t,e){for(var i=[],r=0;r<this.numRows();r++)if(r!=t){for(var a=[],n=0;n<this.numCols();n++)n!=e&&a.push(this.getCell(r,n).clone());i.push(a)}return new Matrix(i)},this.det=function(){return this.determinant()},this.transpose=function(){for(var t=[],e=0;e<this.numCols();e++){for(var i=[],r=0;r<this.numRows();r++)i.push(this.getCell(r,e));t.push(i)}return new Matrix(t)},this.concat=function(t){for(var e=this.clone().matrix,i=0;i<e.length;i++)e[i]=e[i].concat(t.matrix[i]);return new Matrix(e)},this.inverse=function(){for(var t=this.concat(this.getIdentity(this.numCols())).reduceToReducedEchF(this.numCols()),e=0;e<this.numRows();e++){for(var i=0;i<this.numCols();i++)if(i==e){if(!t.getCell(e,i).isOne())throw"Matrix non invertible"}else if(!t.getCell(e,i).isZero())throw"Matrix non invertible";t.matrix[e]=t.matrix[e].slice(this.numCols(),2*this.numCols())}return t},this.add=function(t){for(var e=[],i=0;i<this.numRows();i++){for(var r=[],a=0;a<this.numCols();a++)r.push(this.getCell(i,a).add(t.getCell(i,a)));e.push(r)}return new Matrix(e)},this.subtract=function(t){for(var e=[],i=0;i<this.numRows();i++){for(var r=[],a=0;a<this.numCols();a++)r.push(this.getCell(i,a).subtract(t.getCell(i,a)));e.push(r)}return new Matrix(e)},this.times=function(t){if(!(t instanceof Matrix))return this.timesScalar(t);if(this.numCols()!=t.numRows()||this.numRows()!=t.numCols())throw"Dimension mismatch, can't multiply "+this.numRows()+"x"+this.numCols()+" by "+t.numRows()+"x"+t.numCols();for(var e=new Matrix(this.numRows(),t.numCols()),i=0;i<this.numRows();i++)for(var r=0;r<this.numCols();r++){for(var a=new Fraction,n=0;n<this.numCols();n++)a=a.add(this.getCell(i,n).times(t.getCell(n,r)));e.update(i,r,a)}return e},this.timesScalar=function(t){for(var e=new Matrix(this.numRows(),this.numCols()),i=0;i<this.numRows();i++)for(var r=0;r<this.numCols();r++)e.update(i,r,this.getCell(i,r).times(t));return e},this.divide=function(t){return t instanceof Matrix?this.times(t.inverse()):t instanceof Fraction?this.times(t.reciprocal()):this.times(new Fraction(1,t))},this.power=function(t){if(this.numCols()!=this.numRows())throw"You can only calculate powers of square matricies!";var e;if(t<0)e=this.inverse(),t=Math.abs(t);else{if(0==t)return this.getIdentity();e=this}for(e=this.times(e),i=1;i<t-1;i++)e=this.times(e);return e},this.conjugate=function(t){return t.inverse().times(this).times(t)},this.performFunction=function(t,e){switch(t){case funcENUM.TRANSPOSE:return this.transpose();case funcENUM.INVERSE:return this.inverse();case funcENUM.RANK:return null;case funcENUM.DET:return this.det();case funcENUM.DIAGONALIZE:return null;case funcENUM.ROWREDUCE:return this.reduceToReducedEchF();case funcENUM.SOLVAUG:return this.reduceToReducedEchF(-1);case funcENUM.ID:return this.getIdentity(e[0],e[1]);case funcENUM.ZEROS:return this.getZeros(e[0],e[1])}throw"Something weird just happened!"},this.reduceToReducedEchF=function(t){void 0==t||t>this.numCols()?t=this.numCols():t==-1&&t--;for(var e=this.numRows(),i=this.clone(),r=0,a=0;a<t&&r<e;a++){if(0==i.getCell(r,a)){var n=i.getNonZeroRows(r,a);if(n==-1)continue;i.swap(n,r)}var s=i.getCell(r,a).reciprocal();i.multiplier=i.multiplier.divide(s),i.matrix[r]=i.multiplyRow(r,s),i.kill(r,a),r++}return i},this.kill=function(t,e){for(var i=0;i<this.numRows();i++)if(i!=t){var r=this.getCell(i,e);r.isZero()||(this.matrix[i]=this.subtractRows(this.matrix[i],this.multiplyRow(t,r)))}},this.getNonZeroRows=function(t,e){for(t++;t<this.numRows()&&0==this.getCell(t,e);)t++;return t==this.numRows()?-1:t},this.subtractRows=function(t,e){if(t.length!=e.length)throw"Something weird happened!";for(var i=[],r=0;r<t.length;r++)i.push(t[r].subtract(e[r]));return i},this.multiplyRow=function(t,e){for(var i=[],r=0;r<this.numCols();r++)i.push(this.getCell(t,r).clone().times(e));return i},this.swap=function(t,e){var i=this.matrix[t];this.matrix[t]=this.matrix[e],this.matrix[e]=i,this.multiplier=this.multiplier.times(-1)},this.resize=function(t,e){if(t=parseInt(t),e=parseInt(e),t<this.numRows())this.matrix=this.matrix.slice(0,t);else if(t!=this.numRows()){for(var i=[],r=0;r<e;r++)i.push(new Fraction);this.matrix.push(i)}if(e<this.numCols())for(var a=0;a<t;a++)this.matrix[a]=this.matrix[a].slice(0,e);else if(e!=this.numCols())for(var r=0;r<t;r++)this.matrix[r].push(new Fraction)},this.getIdentity=function(t,e){void 0==t&&void 0!=e&&(t=e),void 0!=t&&void 0==e&&(e=t),void 0==t&&(t=this.numRows()),void 0==e&&(e=this.numCols());for(var i=[],r=0;r<t;r++){for(var a=[],n=0;n<e;n++)r==n?a.push(new Fraction(1)):a.push(new Fraction);i.push(a)}return new Matrix(i)}}function getZeros(t,e){void 0==t&&void 0!=e&&(t=e),void 0!=t&&void 0==e&&(e=t);for(var i=[],r=0;r<t;r++){for(var a=[],n=0;n<e;n++)a.push(new Fraction(0,1));i.push(a)}return new Matrix(i)}function getEnum(t){switch(t.toLowerCase()){case"transpose":case"trans":return funcENUM.TRANSPOSE;case"inverse":case"inv":return funcENUM.INVERSE;case"rank":return funcENUM.RANK;case"det":case"determinant":return funcENUM.DET;case"eigen":return funcENUM.EIGEN;case"diagonalize":return funcENUM.DIAGONALIZE;case"rowreduce":return funcENUM.ROWREDUCE;case"solveaugmented":case"solveaugmentedmatrix":return funcENUM.SOLVAUG;case"id":case"identity":return funcENUM.ID;case"zeros":return funcENUM.ZEROS}return funcENUM.NONE}function getNextFreeLetter(){if(letterIndex++,letterIndex>=alphabet.length&&(letterIndex=0),isValid(alphabet[letterIndex]))return alphabet[letterIndex];var t=alphabet[letterIndex]+parseInt(100*Math.random());return isValid(t)?t:void getNextFreeLetter()}function commandInput(t){try{var e=Date.now();$("#errDisplay").hide(),performCalc(t),$("#cmdinput").val(base);var i=Date.now()-e;successHandle(i),console.log("Operation done in "+i+"ms")}catch(t){errorHandle(t),$("#cmdinput").val($("#cmdinput").val().replace(/\n/g,""))}}function errorHandle(t){console.log(t),$("#errDisplay").css("color","red"),$("#errDisplay").text(t).show()}function successHandle(t){$("#errDisplay").css("color","#008e0d"),$("#errDisplay").text("Command Successful! ("+t+" ms)").show(200),setTimeout(function(){$("#errDisplay").hide(500)},2e3)}function performCalc(t){if(t=t.replace(/ /g,"").replace(/\n/g,""),t.includes(";")){var e=t.split(";");for(var i in e)performCalc(e[i])}else{var r=t,a="",n=!1;if(t.includes("=")){if(n=!0,a=t.split("=")[0],!isValid(a,!0))throw"Invalid Variable Name :(";t=t.split("=")[1]}else a=getNextFreeLetter();t="("+t+")";var s=getArrayFromString(t);if(!n&&3==s.length&&"object"==typeof s[1])return $("#MAT-"+r).trigger("click"),void $("#MAT-"+r).get(0).scrollIntoView();for(var o=0;o<s.length;o++)if(isCloseBracket(s[o])){for(var c=o;!isOpenBracket(s[c]);){if(isOperator(s[c])){var l=calculate(s[c-1],s[c+1],s[c]);s.splice(c,2),s[c-1]=l}c--}if(funcENUM.isFunction(s[c-1])){for(var u=[],h=0;!isCloseBracket(s[h+(c+1)]);)","!=s[h+(c+1)]&&u.push(s[h+(c+1)]),h++;var d=performFunction(s[c-1],u);s.splice(c,h+2),s[c-1]=d}else s.splice(c,1),s.splice(c+1,1);if(0===c)break;o=c-1}if(variables.get(a)){if(typeof variables.get(a)!=typeof s[0])throw"object"==typeof s[0]?"You can't assign a matrix to a number":"You can't assign a number to a matrix";updateGUI(a,s[0])}else newInputComp(a,s[0])}}function getArrayFromString(t){var e=1,i=0,r=[];r.add=function(t){isOpenBracket(t)?e++:isCloseBracket(t)&&i++,this.push(t)},r.push("(");for(var a=1;a<t.length;a++){if(isOperatorOrBracket(t[a])&&!isOperatorOrBracket(t[a-1])){for(var n=a-1,s="";!isOperatorOrBracket(t[n]);)s=t[n]+s,n--;var o;if(isNaN(s)){if((o=getEnum(s))==funcENUM.NONE&&"undefined"==typeof(o=variables.get(s))&&","!=(o=s))throw"Sorry, I don't know what '"+s+"' is :("}else o=new Fraction(s),"-"==r[r.length-1]&&isNaN(r[r.length-2])&&(r.pop(),o=o.times(-1)),"+"==r[r.length-1]&&isNaN(r[r.length-2])&&r.pop();r.push(o)}isOperatorOrBracket(t[a])&&r.add(t[a])}if(e>i)throw"Unexpected character (";if(i>e)throw"Unexpected character )";return r}function performFunction(t,e){if(e[0]instanceof Matrix)return e[0].performFunction(t);if(t!=funcENUM.ID&&t!=funcENUM.ZEROS)throw"Cannot perform operation: "+funcENUM.getString(t)+" of "+e[0];return(new Matrix).performFunction(t,e)}function calculate(t,e,i){var r;switch(i){case"+":if(t instanceof Matrix&&!(e instanceof Matrix)||e instanceof Matrix&&!(t instanceof Matrix))throw"You can't add a matrix and number sorry!";r=t.add(e);break;case"-":if(t instanceof Matrix&&!(e instanceof Matrix)||e instanceof Matrix&&!(t instanceof Matrix))throw"You can't add a matrix and number sorry!";r=t.subtract(e);break;case"/":if(!(t instanceof Matrix)&&e instanceof Matrix)throw"You can't divide a number by a matrix!";r=t.divide(e);break;case"*":r=t instanceof Matrix?t.times(e):e instanceof Matrix?e.times(t):t.times(e);break;case"^":if(t instanceof Matrix)r=e instanceof Matrix?t.conjugate(e):t.power(e);else{if(!(t instanceof Fraction&&e instanceof Fraction))throw"That's not valid maths! ";r=t.power(e)}}return r}function getOperand(t){return isNaN(t)?"object"==typeof t?t:variables.get(t):parseInt(t)}function isOperator(t){return"+^-*/".split("").indexOf(t)>=0}function isCloseBracket(t){return")"==t}function isOpenBracket(t){return"("==t}function isBrackets(t){return isCloseBracket(t)||isOpenBracket(t)}function isOperatorOrBracket(t){return isOperator(t)||isBrackets(t)||","==t}function isSquiggle(t){return"}"==t||"{"==t}function deleteMatrix(t){variables.delete($(t).attr("id").split("-")[1]),t.remove(),$("#bin").attr("src","img/bin.png")}function drawButton(){var t=document.getElementById("cvsNewBtn"),e=t.getContext("2d");e.fillStyle="black",e.moveTo(0,0),e.beginPath();var i=20;e.arc(i,i,i,0,2*Math.PI),e.fill(),e.strokeStyle="white",e.lineWidth=3,e.moveTo(i,5),e.lineTo(i,2*i-5),e.moveTo(5,i),e.lineTo(2*i-5,i),e.stroke()}function newInputComp(t,e){var r,a;null!=e&&void 0!=e||(e=new Matrix),e instanceof Matrix?(a=e.numCols(),r=e.numRows()):r=a=1,variables.set(t,e);var n=$("<div>",{id:"MAT-"+t,class:"matInput draggable drag-drop","data-clicked":0}),s=$("<img>",{class:"handle noSelect",src:"img/dragHandle.png"}),o=$("<span>",{class:"label noSelect"}),c=$("<label>",{class:"pull-left noSelect"}),l=$("<input>",{class:"clickedit",type:"text"});interact(".draggable").draggable({snap:{targets:[interact.createSnapGrid({x:20,y:20})],range:1/0,relativePoints:[{x:0,y:0}]},inertia:!0,restrict:{restriction:"#mainBody",endOnly:!1,elementRect:{top:0,left:0,bottom:0,right:1}},autoScroll:!0,onmove:dragMoveListener}).allowFrom(".handle"),window.dragMoveListener=dragMoveListener,c.append(t),o.append(c),o.append(l),o.append("     = "),n.append(o);var u=$("<div>",{class:"matContainer"}),h=$("<table>",{class:isNaN(e)?"matGui":"",id:"t"+count});for(h.attr("data-cols",a),h.attr("data-rows",r),i=0;i<r;i++){var d=$("<tr>");for(j=0;j<a;j++){var p=$("<td>");p.append(getCell(i,j,e instanceof Matrix?e.getCell(i,j).toString():e instanceof Fraction?e.toString():e)),d.append(p)}h.append(d)}if(u.append(h),n.append(u),isNaN(e)){$modifiers=$("<span>",{class:"guiModifiers"});var m=function(){return $("<img>",{src:"img/arrow.png"})};$colbtn=$("<button>",{class:"addCol colButton rowColModifier noSelect"}),$colbtn.append(m()),$rowbtn=$("<button>",{class:"addRow rowButton rowColModifier noSelect flipY"}),$rowbtn.append(m()),$rmvColbtn=$("<button>",{class:"rmvCol colButton rowColModifier noSelect flip"}),$rmvColbtn.append(m()),$rmvRowbtn=$("<button>",{class:"rmvRow rowButton rowColModifier noSelect addLeftMargin"}),$rmvRowbtn.append(m()),$colbtn.attr("data-tableid","t"+count),$rowbtn.attr("data-tableid","t"+count),$rmvRowbtn.attr("data-tableid","t"+count),$rmvColbtn.attr("data-tableid","t"+count),$colbtn.click(function(t){t.stopImmediatePropagation();var e=0;h=$("#"+$(this).attr("data-tableid"));var i=h.attr("data-cols")-1,r=h.attr("data-rows");h.attr("data-cols",i+2),h.find("tr").each(function(){var t=$("<td>");t.append(getCell(e,i+1,"0")),e++,$(this).find("td").eq(i).after(t)});var a=$(this).closest(".matInput").attr("id").split("-")[1];variables.get(a).resize(parseInt(r),i+2)}),$rowbtn.click(function(t){t.stopImmediatePropagation(),h=$("#"+$(this).attr("data-tableid"));var e=h.attr("data-cols"),r=h.attr("data-rows");for(h.attr("data-rows",parseInt(r)+1),d=$("<tr>"),i=0;i<e;i++)p=$("<td>"),p.append(getCell(r,i,"0")),d.append(p);h.append(d);var a=$(this).closest(".matInput").attr("id").split("-")[1];variables.get(a).resize(parseInt(r)+1,parseInt(e))}),$rmvColbtn.click(function(t){t.stopImmediatePropagation();var e=$("#"+$(this).attr("data-tableid")),i=parseInt(e.attr("data-cols")),r=parseInt(e.attr("data-rows"));if(i>1){$("#"+$(this).attr("data-tableid")+" td:last-child").remove(),i--,e.attr("data-cols",i);var a=$(this).closest(".matInput").attr("id").split("-")[1];variables.get(a).resize(r,i)}}),$rmvRowbtn.click(function(t){t.stopImmediatePropagation();var e=$("#"+$(this).attr("data-tableid")),i=parseInt(e.attr("data-rows")),r=parseInt(e.attr("data-cols"));if(i>1){$("#"+$(this).attr("data-tableid")+" tr:last-child").remove(),i--,e.attr("data-rows",i);var a=$(this).closest(".matInput").attr("id").split("-")[1];variables.get(a).resize(i,r)}}),n.click(function(t){t.stopImmediatePropagation();var e=$(this).attr("id");1==$(this).attr("data-clicked")?($(this).css("background-color","rgba(204, 204, 204, 0.2)"),$(this).attr("data-clicked",0),selected.splice(selected.indexOf(e),1)):($(this).css("background-color","rgba(99, 182, 255, 0.2)"),$(this).attr("data-clicked",1),selected.push(e)),$selectedMatrix=this}),count++,$modifiers.append($rmvRowbtn),$modifiers.append($rowbtn),$modifiers.append($rmvColbtn),$modifiers.append($colbtn),n.append($modifiers)}n.append(s),$("#matDefinitions").append(n),$(".clickedit").hide().focusout(endEdit).keyup(function(t){return t.stopImmediatePropagation(),!(t.which&&13==t.which||t.keyCode&&13==t.keyCode)||(endEdit(t),!1)}).prev().click(function(t){t.stopImmediatePropagation(),$(this).hide(),$(this).next().show().focus()})}function getCell(t,e,i){var r=$("<input>",{class:"matrixCell",type:"text"});return r.val(i),"0"==i&&r.css("color","gray"),r.attr("data-row",t),r.attr("data-col",e),r.click(function(t){t.stopImmediatePropagation(),"0"==$(this).val()&&$(this).val(""),$(this).css("color","black")}),r.change(function(t){t.stopImmediatePropagation();var e=$(this).closest(".matInput").attr("id").split("-")[1],i=$(this).attr("data-row"),a=$(this).attr("data-col");""===$(this).val().trim()?(r.css("color","gray"),variables.get(e).update(i,a,0),$(this).val("0")):variables.get(e).update(i,a,$(this).val())}),r.keyup(function(t){t.stopImmediatePropagation()}),r}function dragMoveListener(t){var e=t.target,i=(parseFloat(e.getAttribute("data-x"))||0)+t.dx,r=(parseFloat(e.getAttribute("data-y"))||0)+t.dy;e.style.webkitTransform=e.style.transform="translate("+i+"px, "+r+"px)",e.setAttribute("data-x",i),e.setAttribute("data-y",r)}function endEdit(t){t.stopImmediatePropagation();var e=$(t.target),i=e&&e.prev(),r=makeCammelCase(e.val()),a=!1;if(isValid(r,!1)){i.text(r);var n=variables.get(i.closest("div").attr("id").split("-")[1]);variables.delete(i.closest("div").attr("id").split("-")[1]),variables.set(r,n),i.closest("div").attr("id","MAT-"+r)}else i.text(i.closest("div").attr("id").split("-")[1]),a=!0;e.hide(),i.show(),e.val(""),a&&errorHandle("Invalid Variable Name :(")}function isValid(t,e){return/^[a-z0-9]+$/i.test(t)&&(!!e||void 0===variables.get(t))&&getEnum(t)===funcENUM.NONE}function makeCammelCase(t){return t=t.replace(/\b[a-z]/g,function(t){return t.toUpperCase()}),t=t.replace(/ /g,"").replace(/-/g,""),t.length>1&&(t=t.charAt(0).toLowerCase()+t.slice(1)),t}function updateGUI(t,e){if(variables.set(t,e),e instanceof Matrix){var i=parseInt(e.numRows()-$("#MAT-"+t).find("table").attr("data-rows")),r=parseInt(e.numCols()-$("#MAT-"+t).find("table").attr("data-cols"));if(0!==i||0!==r){for(var a=$("#MAT-"+t).find(".guiModifiers"),n=a.find(".addCol"),s=a.find(".rmvCol"),o=a.find(".addRow"),c=a.find(".rmvRow"),l=0;l<Math.abs(i);l++)i<0?c.trigger("click"):o.trigger("click");for(var l=0;l<Math.abs(r);l++)r<0?s.trigger("click"):n.trigger("click")}}$("#MAT-"+t).find("table tr").each(function(){$(this).find("td").each(function(){var t=$(this).find("input"),i=t.attr("data-row"),r=t.attr("data-col");t.val(e instanceof Matrix?e.getCell(i,r):e.toString())})})}var variables=new Map,funcENUM={NONE:"#",TRANSPOSE:"#T",INVERSE:"#I",RANK:"#R",DET:"#D",EIGEN:"#E",DIAGONALIZE:"#DI",ROWREDUCE:"#RRD",SOLVAUG:"#SA",ID:"#ID",ZEROS:"#ZE",isFunction:function(t){var e=!1;return $.each(this,function(i,r){r==t&&(e=!0)}),e},getString:function(t){switch(t){case this.TRANSPOSE:return"transpose";case this.RANK:return"rank";case this.INVERSE:return"inverse";case this.DET:return"determinant";case this.EIGEN:return"eigenvalues/vectors";case this.DIAGONALIZE:return"diagonal form";case this.ROWREDUCE:case this.SOLVAUG:return"Reduced Echelon Form";case this.ID:return"identity matrix";case this.ZEROS:return"0 matrix"}return"NOTHING"}},base="MatCalculator >> ",regex=new RegExp("^"+base,"i"),comHist=[];comHist.add=function(t){this.indexOf(t)<0&&this.push(t)};var histPos=0,alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),letterIndex=-1;interact(".dropzone").dropzone({accept:".matInput",ondragenter:function(t){$("#bin").attr("src","img/openBin.png")},ondragleave:function(t){$("#bin").attr("src","img/bin.png")},ondrop:function(t){deleteMatrix(t.relatedTarget);var e=selected.indexOf($(t.relatedTarget).attr("id"));e!=-1&&selected.splice(e,1)}}),$(document).keyup(function(t){if(46==t.keyCode)for(var e in selected)deleteMatrix($("#"+selected[e]));selected=[]});var count=0,selected=[];$(document).ready(function(){$("#cmdinput").on("input",function(t){var e=$(this).val();regex.test(e)||$(this).val(base)}).keyup(function(t){t.stopImmediatePropagation();var e=t.keyCode?t.keyCode:t.which;if(13==e){var i=$(this).val().slice(base.length);comHist.add(i.replace(/\n/g,"")),histPos++,commandInput(i)}else 38==e&&comHist.length>0?(histPos>0&&histPos--,$(this).val(base+comHist[histPos])):40==e&&comHist.length>0?(histPos<comHist.length-1&&histPos++,$(this).val(base+comHist[histPos])):histPos=comHist.length}),drawButton(),$("#btnNewMat").hover(function(){$("#newLabel").show()},function(){$("#newLabel").hide()}).click(function(){newInputComp(getNextFreeLetter())})});